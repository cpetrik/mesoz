mid <- intersect(mid1,mid2)
CMM <- CMM[-mid,]
cm1 <- ggplot(subset(CMM,biome==1), aes(y=zmeso200, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("zmeso") + xlab("obsGLMM chl") + ggtitle("LC") +
scale_y_log10() + scale_x_log10(limits=c(0.02,0.15)) + theme(legend.position='none')
cm2 <- ggplot(subset(CMM,biome==2), aes(y=zmeso200, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("") + ggtitle("HCSS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
cm3 <- ggplot(subset(CMM,biome==3), aes(y=zmeso200, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("") + ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
cm0 <- ggplot(CMM, aes(y=zmeso200, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("") + ggtitle("Global") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
cs1 <- ggplot(subset(CSM,biome==1), aes(y=zmeso200, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) + #, se=FALSE, col="blue", size = 0.25) +
ylab("zmeso") + xlab("Stromberg chl") + #ggtitle("LC") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
cs2 <- ggplot(subset(CSM,biome==2), aes(y=zmeso200, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("") + #ggtitle("HCSS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
cs3 <- ggplot(subset(CSM,biome==3), aes(y=zmeso200, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("") + #ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
cs0 <- ggplot(CSM, aes(y=zmeso200, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("") + #ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
png(paste0(figp,'scatter_hist_mesoz_chl_biomes_global_all_log_LC45.png'),
width = 8*300,        # 5 x 300 pixels
height = 11*300,
res = 300,            # 300 pixels per inch
pointsize = 8)
plot_grid( m1,m2,m3,m0,
NULL,NULL,NULL,NULL,
n1,n2,n3,n0,
NULL,NULL,NULL,NULL,
g1,g2,g3,g0,
NULL,NULL,NULL,NULL,
i1,i2,i3,i0,
NULL,NULL,NULL,NULL,
u1,u2,u3,u0,
nrow = 9, ncol = 4,
rel_widths = c( 1, 1, 1, 1 ),
rel_heights = c(1,-0.15,1,-0.15,1,-0.15,1,-0.15,1) ,
align = 'h' )
dev.off()
u1 <- ggplot(subset(UM,biome==1), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) + #, se=FALSE, col="blue", size = 0.25) +
ylab("UK mesoz") + xlab("chl") + #ggtitle("LC") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
u2 <- ggplot(subset(UM,biome==2), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("chl") + #ggtitle("HCSS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
u3 <- ggplot(subset(UM,biome==3), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("chl") + #ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
u0 <- ggplot(UM, aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("chl") + #ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
o1 <- ggplot(subset(OG,biome==1), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("obsGLMM") + xlab("Mchl") + #ggtitle("LC") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
o2 <- ggplot(subset(OG,biome==2), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Mchl") + #ggtitle("HCSS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
o3 <- ggplot(subset(OG,biome==3), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Mchl") + #ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
o0 <- ggplot(OG, aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Mchl") + #ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
s1 <- ggplot(subset(SM,biome==1), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) + #, se=FALSE, col="blue", size = 0.25) +
ylab("obsSM") + xlab("Schl") + #ggtitle("LC") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
s2 <- ggplot(subset(SM,biome==2), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Schl") + #ggtitle("HCSS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
s3 <- ggplot(subset(SM,biome==3), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Schl") + #ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
s0 <- ggplot(SM, aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Schl") + #ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
# COPEPOD OBS
Zm <- read.csv(paste0(datap,"skill_hist_COPEPOD_all_clim_200_chls.csv"),sep=",",header = T,stringsAsFactors = F)
CSM <- as.data.frame(Zm[,c("Lat","Lon","zmeso200","SEAWIFSchl","SEAWIFSbiomes")])
CSM <- na.omit(CSM)
names(CSM) <- c("Lat","Lon","zmeso200","chl","biome")
CMM <- as.data.frame(Zm[,c("Lat","Lon","zmeso200","MODISchl","MODISbiomes")])
CMM <- na.omit(CMM)
names(CMM) <- c("Lat","Lon","zmeso200","chl","biome")
# from mgC to gC
CSM$zmeso200 <- CSM$zmeso200*1e-3
CMM$zmeso200 <- CMM$zmeso200*1e-3
CSM$Lzmeso <- log10(CSM$zmeso200+1e-16)
CMM$Lzmeso <- log10(CMM$zmeso200+1e-16)
CSM$Lchl <- log10(CSM$chl+1e-16)
CMM$Lchl <- log10(CMM$chl+1e-16)
# Remove LC >45 lat BUT THIS MAY EXPAND OUTSIDE 45DEG UNDER SSP585!?!
sid1 <- which(CSM$biome==1)
sid2 <- which(CSM$Lat > 45 | CSM$Lat < -45)
sid <- intersect(sid1,sid2)
CSM <- CSM[-sid,]
mid1 <- which(CMM$biome==1)
mid2 <- which(CMM$Lat > 45 | CMM$Lat < -45)
mid <- intersect(mid1,mid2)
CMM <- CMM[-mid,]
cm1 <- ggplot(subset(CMM,biome==1), aes(y=zmeso200, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("COPEPOD") + xlab("Mchl") + ggtitle("LC") +
scale_y_log10() + scale_x_log10(limits=c(0.02,0.15)) + theme(legend.position='none')
cm2 <- ggplot(subset(CMM,biome==2), aes(y=zmeso200, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Mchl") + ggtitle("HCSS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
cm3 <- ggplot(subset(CMM,biome==3), aes(y=zmeso200, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Mchl") + ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
cm0 <- ggplot(CMM, aes(y=zmeso200, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Mchl") + ggtitle("Global") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
cs1 <- ggplot(subset(CSM,biome==1), aes(y=zmeso200, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) + #, se=FALSE, col="blue", size = 0.25) +
ylab("COPEPOD") + xlab("Schl") + #ggtitle("LC") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
cs2 <- ggplot(subset(CSM,biome==2), aes(y=zmeso200, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Schl") + #ggtitle("HCSS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
cs3 <- ggplot(subset(CSM,biome==3), aes(y=zmeso200, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Schl") + #ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
cs0 <- ggplot(CSM, aes(y=zmeso200, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Schl") + #ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
png(paste0(figp,'scatter_hist_mesoz_chl_biomes_global_all_log_LC45.png'),
width = 8*300,        # 5 x 300 pixels
height = 9*300,
res = 300,            # 300 pixels per inch
pointsize = 8)
plot_grid( m1,m2,m3,m0,
NULL,NULL,NULL,NULL,
n1,n2,n3,n0,
NULL,NULL,NULL,NULL,
g1,g2,g3,g0,
NULL,NULL,NULL,NULL,
i1,i2,i3,i0,
NULL,NULL,NULL,NULL,
u1,u2,u3,u0,
nrow = 9, ncol = 4,
rel_widths = c( 1, 1, 1, 1 ),
rel_heights = c(1,-0.15,1,-0.15,1,-0.15,1,-0.15,1) ,
align = 'h' )
dev.off()
## Zoo & Chl biomes sep
c1 <- ggplot(subset(CM,biome==1), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("CAN zmeso") + xlab("") + ggtitle("LC") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
m1 <- ggplot(subset(MM,biome==1), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("CMCC zmeso") + xlab("") + ggtitle("LC") +
scale_y_log10() + scale_x_log10(limits=c(0.02,0.15)) + theme(legend.position='none')
n1 <- ggplot(subset(NM,biome==1), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("CNRM zmeso") + xlab("") + #ggtitle("LC") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
g1 <- ggplot(subset(GM,biome==1), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("GFDL zmeso") + xlab("") + #ggtitle("LC") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
i1 <- ggplot(subset(IM,biome==1), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("IPSL zmeso") + xlab("") + #ggtitle("LC") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
u1 <- ggplot(subset(UM,biome==1), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) + #, se=FALSE, col="blue", size = 0.25) +
ylab("UK zmeso") + xlab("chl") + #ggtitle("LC") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
png(paste0(figp,'scatter_hist_mesoz_chl_biomes_global_all_log_LC45.png'),
width = 8*300,        # 5 x 300 pixels
height = 9*300,
res = 300,            # 300 pixels per inch
pointsize = 8)
plot_grid( m1,m2,m3,m0,
NULL,NULL,NULL,NULL,
n1,n2,n3,n0,
NULL,NULL,NULL,NULL,
g1,g2,g3,g0,
NULL,NULL,NULL,NULL,
i1,i2,i3,i0,
NULL,NULL,NULL,NULL,
u1,u2,u3,u0,
nrow = 9, ncol = 4,
rel_widths = c( 1, 1, 1, 1 ),
rel_heights = c(1,-0.15,1,-0.15,1,-0.15,1,-0.15,1) ,
align = 'h' )
dev.off()
png(paste0(figp,'scatter_mesoz_chl_biomes_global_all_log_glm100_strom_copepod_LC45.png'),
width = 8*300,        # 5 x 300 pixels
height = 8*300,
res = 300,            # 300 pixels per inch
pointsize = 8)
plot_grid( o1,o2,o3,o0,
s1,s2,s3,s0,
cm1,cm2,cm3,cm0,
cs1,cs2,cs3,cs0,
nrow = 4, ncol = 4,
rel_widths = c( 1, 1, 1, 1 ),
rel_heights = c(1,1,1,1) ,
align = 'h' )
dev.off()
o1 <- ggplot(subset(OG,biome==1), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("obsGLMM") + xlab("Mchl") + ggtitle("LC") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
o2 <- ggplot(subset(OG,biome==2), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Mchl") + ggtitle("HCSS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
o3 <- ggplot(subset(OG,biome==3), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Mchl") + ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
o0 <- ggplot(OG, aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Mchl") + ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
cm1 <- ggplot(subset(CMM,biome==1), aes(y=zmeso200, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("COPEPOD") + xlab("Mchl") + #ggtitle("LC") +
scale_y_log10() + scale_x_log10(limits=c(0.02,0.15)) + theme(legend.position='none')
cm2 <- ggplot(subset(CMM,biome==2), aes(y=zmeso200, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Mchl") + #ggtitle("HCSS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
cm3 <- ggplot(subset(CMM,biome==3), aes(y=zmeso200, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Mchl") + #ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
cm0 <- ggplot(CMM, aes(y=zmeso200, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Mchl") + #ggtitle("Global") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
png(paste0(figp,'scatter_mesoz_chl_biomes_global_all_log_glm100_strom_copepod_LC45.png'),
width = 8*300,        # 5 x 300 pixels
height = 8*300,
res = 300,            # 300 pixels per inch
pointsize = 8)
plot_grid( o1,o2,o3,o0,
NULL,NULL,NULL,NULL,
s1,s2,s3,s0,
NULL,NULL,NULL,NULL,
cm1,cm2,cm3,cm0,
NULL,NULL,NULL,NULL,
cs1,cs2,cs3,cs0,
nrow = 7, ncol = 4,
rel_widths = c( 1, 1, 1, 1 ),
rel_heights = c(1,-0.15,1,-0.15,1,-0.15,1) ,
align = 'h' )
dev.off()
png(paste0(figp,'scatter_mesoz_chl_biomes_global_all_log_glm100_strom_copepod_LC45.png'),
width = 8*300,        # 5 x 300 pixels
height = 7*300,
res = 300,            # 300 pixels per inch
pointsize = 8)
plot_grid( o1,o2,o3,o0,
NULL,NULL,NULL,NULL,
s1,s2,s3,s0,
NULL,NULL,NULL,NULL,
cm1,cm2,cm3,cm0,
NULL,NULL,NULL,NULL,
cs1,cs2,cs3,cs0,
nrow = 7, ncol = 4,
rel_widths = c( 1, 1, 1, 1 ),
rel_heights = c(1,-0.15,1,-0.15,1,-0.15,1) ,
align = 'h' )
dev.off()
o1 <- ggplot(subset(OG,biome==1), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("obsGLMM") + xlab("Mchl") + ggtitle("LC") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
o2 <- ggplot(subset(OG,biome==2), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Mchl") + ggtitle("HCSS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
o3 <- ggplot(subset(OG,biome==3), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Mchl") + ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
o0 <- ggplot(OG, aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Mchl") + ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
s1 <- ggplot(subset(SM,biome==1), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) + #, se=FALSE, col="blue", size = 0.25) +
ylab("obsSM") + xlab("Schl") + #ggtitle("LC") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
s2 <- ggplot(subset(SM,biome==2), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Schl") + #ggtitle("HCSS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
s3 <- ggplot(subset(SM,biome==3), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Schl") + #ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
s0 <- ggplot(SM, aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Schl") + #ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
cm1 <- ggplot(subset(CMM,biome==1), aes(y=zmeso200, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("COPEPOD") + xlab("Mchl") + #ggtitle("LC") +
scale_y_log10() + scale_x_log10(limits=c(0.02,0.15)) + theme(legend.position='none')
cm2 <- ggplot(subset(CMM,biome==2), aes(y=zmeso200, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Mchl") + #ggtitle("HCSS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
cm3 <- ggplot(subset(CMM,biome==3), aes(y=zmeso200, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Mchl") + #ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
cm0 <- ggplot(CMM, aes(y=zmeso200, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Mchl") + #ggtitle("Global") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
cs1 <- ggplot(subset(CSM,biome==1), aes(y=zmeso200, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) + #, se=FALSE, col="blue", size = 0.25) +
ylab("COPEPOD") + xlab("Schl") + #ggtitle("LC") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
cs2 <- ggplot(subset(CSM,biome==2), aes(y=zmeso200, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Schl") + #ggtitle("HCSS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
cs3 <- ggplot(subset(CSM,biome==3), aes(y=zmeso200, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Schl") + #ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
cs0 <- ggplot(CSM, aes(y=zmeso200, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Schl") + #ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
png(paste0(figp,'scatter_mesoz_chl_biomes_global_all_log_glm100_strom_copepod_LC45.png'),
width = 8*300,        # 5 x 300 pixels
height = 7*300,
res = 300,            # 300 pixels per inch
pointsize = 8)
plot_grid( o1,o2,o3,o0,
NULL,NULL,NULL,NULL,
s1,s2,s3,s0,
NULL,NULL,NULL,NULL,
cm1,cm2,cm3,cm0,
NULL,NULL,NULL,NULL,
cs1,cs2,cs3,cs0,
nrow = 7, ncol = 4,
rel_widths = c( 1, 1, 1, 1 ),
rel_heights = c(1,-0.15,1,-0.15,1,-0.15,1) ,
align = 'h' )
dev.off()
png(paste0(figp,'scatter_mesoz_chl_biomes_global_all_log_glm100_strom_copepod_LC45.png'),
width = 8*300,        # 5 x 300 pixels
height = 7*300,
res = 300,            # 300 pixels per inch
pointsize = 8)
plot_grid( o1,o2,o3,o0,
NULL,NULL,NULL,NULL,
s1,s2,s3,s0,
NULL,NULL,NULL,NULL,
cm1,cm2,cm3,cm0,
NULL,NULL,NULL,NULL,
cs1,cs2,cs3,cs0,
nrow = 7, ncol = 4,
rel_widths = c( 1, 1, 1, 1 ),
rel_heights = c(1,-0.1,1,-0.1,1,-0.1,1) ,
align = 'h' )
dev.off()
png(paste0(figp,'scatter_mesoz_chl_biomes_global_all_log_glm100_strom_copepod_LC45.png'),
width = 8*300,        # 5 x 300 pixels
height = 7*300,
res = 300,            # 300 pixels per inch
pointsize = 8)
plot_grid( o1,o2,o3,o0,
NULL,NULL,NULL,NULL,
s1,s2,s3,s0,
NULL,NULL,NULL,NULL,
cm1,cm2,cm3,cm0,
NULL,NULL,NULL,NULL,
cs1,cs2,cs3,cs0,
nrow = 7, ncol = 4,
rel_widths = c( 1, 1, 1, 1 ),
rel_heights = c(1,-0.05,1,-0.05,1,-0.05,1) ,
align = 'h' )
dev.off()
png(paste0(figp,'scatter_mesoz_chl_biomes_global_all_log_glm100_strom_copepod_LC45.png'),
width = 8*300,        # 5 x 300 pixels
height = 8*300,
res = 300,            # 300 pixels per inch
pointsize = 8)
plot_grid( o1,o2,o3,o0,
NULL,NULL,NULL,NULL,
s1,s2,s3,s0,
NULL,NULL,NULL,NULL,
cm1,cm2,cm3,cm0,
NULL,NULL,NULL,NULL,
cs1,cs2,cs3,cs0,
nrow = 7, ncol = 4,
rel_widths = c( 1, 1, 1, 1 ),
rel_heights = c(1,-0.05,1,-0.05,1,-0.05,1) ,
align = 'h' )
dev.off()
o0 <- ggplot(OG, aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Mchl") + ggtitle("Global") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
png(paste0(figp,'scatter_mesoz_chl_biomes_global_all_log_glm100_strom_copepod_LC45.png'),
width = 8*300,        # 5 x 300 pixels
height = 8*300,
res = 300,            # 300 pixels per inch
pointsize = 8)
plot_grid( o1,o2,o3,o0,
NULL,NULL,NULL,NULL,
s1,s2,s3,s0,
NULL,NULL,NULL,NULL,
cm1,cm2,cm3,cm0,
NULL,NULL,NULL,NULL,
cs1,cs2,cs3,cs0,
nrow = 7, ncol = 4,
rel_widths = c( 1, 1, 1, 1 ),
rel_heights = c(1,-0.05,1,-0.05,1,-0.05,1) ,
align = 'h' )
dev.off()
