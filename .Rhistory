ylab("") + xlab("") + ggtitle("HCSS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
m3 <- ggplot(subset(MM,biome==3), aes(y=zmeso, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("") + ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
m0 <- ggplot(MM, aes(y=zmeso, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 500) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("") + ggtitle("Global") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
n1 <- ggplot(subset(NM,biome==1), aes(y=zmeso, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("CNRM zmeso") + xlab("") + #ggtitle("LC") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
n2 <- ggplot(subset(NM,biome==2), aes(y=zmeso, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("") + #ggtitle("HCSS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
n3 <- ggplot(subset(NM,biome==3), aes(y=zmeso, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("") + #ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
n0 <- ggplot(NM, aes(y=zmeso, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("") + #ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
g1 <- ggplot(subset(GM,biome==1), aes(y=zmeso, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("GFDL zmeso") + xlab("") + #ggtitle("LC") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
g2 <- ggplot(subset(GM,biome==2), aes(y=zmeso, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("") + #ggtitle("HCSS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
g3 <- ggplot(subset(GM,biome==3), aes(y=zmeso, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("") + #ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
g0 <- ggplot(GM, aes(y=zmeso, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("") + #ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
i1 <- ggplot(subset(IM,biome==1), aes(y=zmeso, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("IPSL zmeso") + xlab("") + #ggtitle("LC") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
i2 <- ggplot(subset(IM,biome==2), aes(y=zmeso, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("") + #ggtitle("HCSS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
i3 <- ggplot(subset(IM,biome==3), aes(y=zmeso, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("") + #ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
i0 <- ggplot(IM, aes(y=zmeso, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("") + #ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
u1 <- ggplot(subset(UM,biome==1), aes(y=zmeso, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) + #, se=FALSE, col="blue", size = 0.25) +
ylab("UK zmeso") + xlab("chl") + #ggtitle("LC") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
u2 <- ggplot(subset(UM,biome==2), aes(y=zmeso, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("chl") + #ggtitle("HCSS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
u3 <- ggplot(subset(UM,biome==3), aes(y=zmeso, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("chl") + #ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
u0 <- ggplot(UM, aes(y=zmeso, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("chl") + #ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
o1 <- ggplot(subset(OG,biome==1), aes(y=zmeso, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("obsGLMM") + xlab("Mchl") + ggtitle("LC") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
o2 <- ggplot(subset(OG,biome==2), aes(y=zmeso, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Mchl") + ggtitle("HCSS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
o3 <- ggplot(subset(OG,biome==3), aes(y=zmeso, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Mchl") + ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
o0 <- ggplot(OG, aes(y=zmeso, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Mchl") + ggtitle("Global") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
s1 <- ggplot(subset(SM,biome==1), aes(y=zmeso, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) + #, se=FALSE, col="blue", size = 0.25) +
ylab("obsSM") + xlab("Schl") + #ggtitle("LC") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
s2 <- ggplot(subset(SM,biome==2), aes(y=zmeso, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Schl") + #ggtitle("HCSS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
s3 <- ggplot(subset(SM,biome==3), aes(y=zmeso, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Schl") + #ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
s0 <- ggplot(SM, aes(y=zmeso, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Schl") + #ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
# COPEPOD OBS
Zm <- read.csv(paste0(datap,"skill_hist_COPEPOD_all_clim_200_chls.csv"),sep=",",header = T,stringsAsFactors = F)
CSM <- as.data.frame(Zm[,c("Lat","Lon","zmeso200","SEAWIFSchl","SEAWIFSbiomes")])
CSM <- na.omit(CSM)
names(CSM) <- c("Lat","Lon","zmeso200","chl","biome")
CMM <- as.data.frame(Zm[,c("Lat","Lon","zmeso200","MODISchl","MODISbiomes")])
CMM <- na.omit(CMM)
names(CMM) <- c("Lat","Lon","zmeso200","chl","biome")
sid1 <- which(CSM$biome==1)
sid2 <- which(CSM$Lat > 45 | CSM$Lat < -45)
sid <- intersect(sid1,sid2)
CSM <- CSM[-sid,]
mid1 <- which(CMM$biome==1)
mid2 <- which(CMM$Lat > 45 | CMM$Lat < -45)
mid <- intersect(mid1,mid2)
CMM <- CMM[-mid,]
cm1 <- ggplot(subset(CMM,biome==1), aes(y=zmeso200, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("obsMO") + xlab("Mchl") + #ggtitle("LC") +
scale_y_log10() + scale_x_log10(limits=c(0.02,0.15)) + theme(legend.position='none')
cm2 <- ggplot(subset(CMM,biome==2), aes(y=zmeso200, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Mchl") + #ggtitle("HCSS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
cm3 <- ggplot(subset(CMM,biome==3), aes(y=zmeso200, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Mchl") + #ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
cm0 <- ggplot(CMM, aes(y=zmeso200, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Mchl") + #ggtitle("Global") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
cs1 <- ggplot(subset(CSM,biome==1), aes(y=zmeso200, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) + #, se=FALSE, col="blue", size = 0.25) +
ylab("obsMO") + xlab("Schl") + #ggtitle("LC") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
cs2 <- ggplot(subset(CSM,biome==2), aes(y=zmeso200, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Schl") + #ggtitle("HCSS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
cs3 <- ggplot(subset(CSM,biome==3), aes(y=zmeso200, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Schl") + #ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
cs0 <- ggplot(CSM, aes(y=zmeso200, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Schl") + #ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
png(paste0(figp,'scatter_hist_zmeso_chl_biomes_global_all_log_LC45_mgC.png'),
width = 8*300,        # 5 x 300 pixels
height = 9*300,
res = 300,            # 300 pixels per inch
pointsize = 8)
plot_grid( m1,m2,m3,m0,
NULL,NULL,NULL,NULL,
n1,n2,n3,n0,
NULL,NULL,NULL,NULL,
g1,g2,g3,g0,
NULL,NULL,NULL,NULL,
i1,i2,i3,i0,
NULL,NULL,NULL,NULL,
u1,u2,u3,u0,
nrow = 9, ncol = 4,
rel_widths = c( 1, 1, 1, 1 ),
rel_heights = c(1,-0.15,1,-0.15,1,-0.15,1,-0.15,1) ,
align = 'h' )
dev.off()
png(paste0(figp,'scatter_zmeso_chl_biomes_global_all_log_glm100_strom_copepod_LC45_mgC.png'),
width = 8*300,        # 5 x 300 pixels
height = 8*300,
res = 300,            # 300 pixels per inch
pointsize = 8)
plot_grid( o1,o2,o3,o0,
NULL,NULL,NULL,NULL,
s1,s2,s3,s0,
NULL,NULL,NULL,NULL,
cm1,cm2,cm3,cm0,
NULL,NULL,NULL,NULL,
cs1,cs2,cs3,cs0,
nrow = 7, ncol = 4,
rel_widths = c( 1, 1, 1, 1 ),
rel_heights = c(1,-0.05,1,-0.05,1,-0.05,1) ,
align = 'h' )
dev.off()
rm(list=ls())
library(Hmisc) #rcorr
library(plyr)
library(cowplot) #plot_grid
source(file = "/Users/cpetrik/Dropbox/UCSC/CVC-LCM/CVC_data/outmigration_model/HighstatLibV6.r")
setwd("/Users/cpetrik/Dropbox/Princeton/Fish-MIP/CMIP6/driver_analysis/zmeso_matlab/")
figp <- "/Users/cpetrik/Dropbox/Princeton/Fish-MIP/CMIP6/driver_analysis/zmeso_figs/"
datap = "/Users/cpetrik/Dropbox/Princeton/Fish-MIP/CMIP6/driver_analysis/data_stats_zmeso/"
# load data
Zm <- read.csv(paste0(datap,"skill_hist_model_obsglm100_all_clim_200.csv"),sep=",",header = T,stringsAsFactors = F)
Chl <- read.csv(paste0(datap,"hist_chl_model_obsglm100_all_clim.csv"),sep=",",header = T,stringsAsFactors = F)
Sst <- read.csv(paste0(datap,"hist_sst_model_obsglm100_all_clim.csv"),sep=",",header = T,stringsAsFactors = F)
#Units from g to mg
Zm[,3:9] <- 1e3*Zm[,3:9]
CM <- as.data.frame(Zm[,c(1:3,10)])
CM[,5] <- as.data.frame(Chl[,3])
CM[,6] <- as.data.frame(Sst[,3])
names(CM) <- c("Lat","Lon","mesoz","biome","chl","sst")
CM <- na.omit(CM)
OG <- as.data.frame(Zm[,c(1:2,9,16)])
OG[,5] <- as.data.frame(Chl[,9])
OG[,6] <- as.data.frame(Sst[,9])
names(OG) <- c("Lat","Lon","mesoz","biome","chl","sst")
OG <- na.omit(OG)
## Restrict latitudes to those observed
maxlat <- max(OG$Lat)
minlat <- min(OG$Lat)
CM <- subset(CM, Lat >= minlat & Lat <= maxlat)
## Remove LC >45 lat BUT THIS MAY EXPAND OUTSIDE 45DEG UNDER SSP585!?!
cid1 <- which(CM$biome==1)
cid2 <- which(CM$Lat > 45 | CM$Lat < -45)
cid <- intersect(cid1,cid2)
CM <- CM[-cid,]
## Zoo & Chl biomes sep
c1 <- ggplot(subset(CM,biome==1), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("CAN mesoz") + xlab("chl") + ggtitle("LC") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
c2 <- ggplot(subset(CM,biome==2), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("chl") + ggtitle("HCSS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
c3 <- ggplot(subset(CM,biome==3), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("chl") + ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
c0 <- ggplot(CM, aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("chl") + ggtitle("Global") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
png(paste0(figp,'scatter_hist_mesoz_chl_biomes_global_CAN_log_obsglm100_LC45_mgC.png'),
width = 8*300,        # 5 x 300 pixels
height = 2*300,
res = 300,            # 300 pixels per inch
pointsize = 8)
plot_grid( c1,c2,c3,c0,
nrow = 1, ncol = 4,
rel_widths = c( 1, 1, 1, 1), rel_heights = c( 1, 1, 1, 1 ) ,
align = 'h' )
dev.off()
## Zoo & Chl biomes sep
c1 <- ggplot(subset(CM,biome==1), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("CAN zmeso") + xlab("chl") + ggtitle("LC") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
png(paste0(figp,'scatter_hist_mesoz_chl_biomes_global_CAN_log_obsglm100_LC45_mgC.png'),
width = 8*300,        # 5 x 300 pixels
height = 2*300,
res = 300,            # 300 pixels per inch
pointsize = 8)
plot_grid( c1,c2,c3,c0,
nrow = 1, ncol = 4,
rel_widths = c( 1, 1, 1, 1), rel_heights = c( 1, 1, 1, 1 ) ,
align = 'h' )
dev.off()
rm(list=ls())
source(file = "/Users/cpetrik/Dropbox/UCSC/CVC-LCM/CVC_data/outmigration_model/HighstatLibV6.r")
setwd("/Users/cpetrik/Dropbox/Princeton/Fish-MIP/CMIP6/driver_analysis/zmeso_matlab/")
figp <- "/Users/cpetrik/Dropbox/Princeton/Fish-MIP/CMIP6/driver_analysis/zmeso_figs/"
ddir <- "/Users/cpetrik/Dropbox/Princeton/Fish-MIP/CMIP6/driver_analysis/data_stats_zmeso/"
frval <- read.csv(paste0(ddir,"corr_hist_clims_200_copepod_log10_KK_1e4.csv"),sep=",",header = T,stringsAsFactors = F)
kval <- read.csv(paste0(ddir,"Kendall_corr_hist_clims_200_copepod_log10_KK_1e4.csv"),sep=",",header = T,stringsAsFactors = F)
sval <- read.csv(paste0(ddir,"Spearman_corr_hist_clims_200_copepod_log10_KK_1e4.csv"),sep=",",header = T,stringsAsFactors = F)
frms <- read.csv(paste0(ddir,"urmse_hist_clims_200_copepod_log10_KK_1e4.csv"),sep=",",header = T,stringsAsFactors = F)
fbia <- read.csv(paste0(ddir,"bias_hist_clims_200_copepod_log10_KK_1e4.csv"),sep=",",header = T,stringsAsFactors = F)
fmae <- read.csv(paste0(ddir,"mae_hist_clims_200_copepod_log10_KK_1e4.csv"),sep=",",header = T,stringsAsFactors = F)
frval <- frval[2:7,]
frms <- frms[2:7,]
fbia <- fbia[2:7,]
fmae <- fmae[2:7,]
names(frval)[1] <- "Model"
names(kval)[1] <- "Model"
names(sval)[1] <- "Model"
names(frms)[1] <- "Model"
names(fbia)[1] <- "Model"
names(fmae)[1] <- "Model"
frval3 <- melt(frval)
library(Hmisc)
library(ggplot2)
library(gridExtra)
library(corrgram)
library(scatterplot3d)
library(rpart)
library(tree)
library(pvclust)
library(mclust)
library(dendextend)
library(gplots)
library("corrplot")
library(scico)
library(reshape2)
frval <- read.csv(paste0(ddir,"corr_hist_clims_200_copepod_log10_KK_1e4.csv"),sep=",",header = T,stringsAsFactors = F)
kval <- read.csv(paste0(ddir,"Kendall_corr_hist_clims_200_copepod_log10_KK_1e4.csv"),sep=",",header = T,stringsAsFactors = F)
sval <- read.csv(paste0(ddir,"Spearman_corr_hist_clims_200_copepod_log10_KK_1e4.csv"),sep=",",header = T,stringsAsFactors = F)
frms <- read.csv(paste0(ddir,"urmse_hist_clims_200_copepod_log10_KK_1e4.csv"),sep=",",header = T,stringsAsFactors = F)
fbia <- read.csv(paste0(ddir,"bias_hist_clims_200_copepod_log10_KK_1e4.csv"),sep=",",header = T,stringsAsFactors = F)
fmae <- read.csv(paste0(ddir,"mae_hist_clims_200_copepod_log10_KK_1e4.csv"),sep=",",header = T,stringsAsFactors = F)
frval <- frval[2:7,]
frms <- frms[2:7,]
fbia <- fbia[2:7,]
fmae <- fmae[2:7,]
names(frval)[1] <- "Model"
names(kval)[1] <- "Model"
names(sval)[1] <- "Model"
names(frms)[1] <- "Model"
names(fbia)[1] <- "Model"
names(fmae)[1] <- "Model"
frval3 <- melt(frval)
names(frval3) <- c("Model","Season","Corr")
kval3 <- melt(kval)
names(kval3) <- c("Model","Season","Corr")
sval3 <- melt(sval)
names(sval3) <- c("Model","Season","Corr")
frms3 <- melt(frms)
names(frms3) <- c("Model","Season","RMSE")
fbia3 <- melt(fbia)
names(fbia3) <- c("Model","Season","Bias")
fmae3 <- melt(fmae)
names(fmae3) <- c("Model","Season","MAE")
frval3$Model <- factor(frval3$Model,levels = c("UK","IPSL","GFDL","CNRM","CMCC","CAN"))
kval3$Model <- factor(kval3$Model,levels = c("UK","IPSL","GFDL","CNRM","CMCC","CAN"))
sval3$Model <- factor(sval3$Model,levels = c("UK","IPSL","GFDL","CNRM","CMCC","CAN"))
frms3$Model <- factor(frms3$Model,levels = c("UK","IPSL","GFDL","CNRM","CMCC","CAN"))
fbia3$Model <- factor(fbia3$Model,levels = c("UK","IPSL","GFDL","CNRM","CMCC","CAN"))
fmae3$Model <- factor(fmae3$Model,levels = c("UK","IPSL","GFDL","CNRM","CMCC","CAN"))
frms3$RMSE <- abs(frms3$RMSE)
### Heatmaps
frp <- ggplot(data = frval3, aes(y=Model, x=Season, fill=Corr)) +
geom_tile(color = "white") +
scale_fill_distiller(palette = "RdBu", limit = c(-0.6,0.6),
name="Pearson\nCorrelation") +
theme_minimal() + labs(x="")+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1)) +
coord_fixed() +
geom_text(aes(Season, Model, label = signif(Corr,digits = 2)), color = "black", size = 3)
frk <- ggplot(data = kval3, aes(y=Model, x=Season, fill=Corr)) +
geom_tile(color = "white") +
scale_fill_distiller(palette = "RdBu", limit = c(-0.55,0.55),
name="Kendall\nCorrelation") +
theme_minimal() + labs(x="")+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1)) +
coord_fixed() +
geom_text(aes(Season, Model, label = signif(Corr,digits = 2)), color = "black", size = 3)
frs <- ggplot(data = sval3, aes(y=Model, x=Season, fill=Corr)) +
geom_tile(color = "white") +
scale_fill_distiller(palette = "RdBu", limit = c(-0.75,0.75),
name="Spearman\nCorrelation") +
theme_minimal() + labs(x="")+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1)) +
coord_fixed() +
geom_text(aes(Season, Model, label = signif(Corr,digits = 2)), color = "black", size = 3)
frb <- ggplot(data = fbia3, aes(y=Model, x=Season, fill=Bias)) +
geom_tile(color = "white")+
scale_fill_distiller(palette = "PRGn", name="Bias", limit = c(-0.49,0.49)) +
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1))+
coord_fixed() +
geom_text(aes(Season, Model, label = signif(Bias,digits = 2)), color = "black", size = 3)
fae <- ggplot(data = fmae3, aes(y=Model, x=Season, fill=MAE)) +
geom_tile(color = "white") +
scale_fill_distiller(palette = "YlOrBr", trans = "reverse", name="MAE",
limit = c(0.66,0.2)) +
theme_minimal() + labs(x="")+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1))+
coord_fixed() +
geom_text(aes(Season, Model, label = signif(MAE,digits = 2)), color = "black", size = 3)
zrval <- read.csv(paste0(ddir,"corr_hist_clims_200_stromberg_log10_KK_1e4.csv"),sep=",",header = T,stringsAsFactors = F)
zkval <- read.csv(paste0(ddir,"Kendall_corr_hist_clims_200_stromberg_log10_KK_1e4.csv"),sep=",",header = T,stringsAsFactors = F)
zsval <- read.csv(paste0(ddir,"Spearman_corr_hist_clims_200_stromberg_log10_KK_1e4.csv"),sep=",",header = T,stringsAsFactors = F)
zrms <- read.csv(paste0(ddir,"urmse_hist_clims_200_stromberg_log10_KK_1e4.csv"),sep=",",header = T,stringsAsFactors = F)
zbia <- read.csv(paste0(ddir,"bias_hist_clims_200_stromberg_log10_KK_1e4.csv"),sep=",",header = T,stringsAsFactors = F)
zmae <- read.csv(paste0(ddir,"mae_hist_clims_200_stromberg_log10_KK_1e4.csv"),sep=",",header = T,stringsAsFactors = F)
zrval <- zrval[2:7,]
zrms <- zrms[2:7,]
zbia <- zbia[2:7,]
zmae <- zmae[2:7,]
names(zrval)[1] <- "Model"
names(zkval)[1] <- "Model"
names(zsval)[1] <- "Model"
names(zrms)[1] <- "Model"
names(zbia)[1] <- "Model"
names(zmae)[1] <- "Model"
zrval3 <- melt(zrval)
names(zrval3) <- c("Model","Season","Corr")
zkval3 <- melt(zkval)
names(zkval3) <- c("Model","Season","Corr")
zsval3 <- melt(zsval)
names(zsval3) <- c("Model","Season","Corr")
zrms3 <- melt(zrms)
names(zrms3) <- c("Model","Season","RMSE")
zbia3 <- melt(zbia)
names(zbia3) <- c("Model","Season","Bias")
zmae3 <- melt(zmae)
names(zmae3) <- c("Model","Season","MAE")
zrval3$Model <- factor(zrval3$Model,levels = c("UK","IPSL","GFDL","CNRM","CMCC","CAN"))
zkval3$Model <- factor(zkval3$Model,levels = c("UK","IPSL","GFDL","CNRM","CMCC","CAN"))
zsval3$Model <- factor(zsval3$Model,levels = c("UK","IPSL","GFDL","CNRM","CMCC","CAN"))
zrms3$Model <- factor(zrms3$Model,levels = c("UK","IPSL","GFDL","CNRM","CMCC","CAN"))
zbia3$Model <- factor(zbia3$Model,levels = c("UK","IPSL","GFDL","CNRM","CMCC","CAN"))
zmae3$Model <- factor(zmae3$Model,levels = c("UK","IPSL","GFDL","CNRM","CMCC","CAN"))
zrms3$RMSE <- abs(zrms3$RMSE)
### Heatmaps - use same colorscale as obsGLMM for easy comp
zrp <- ggplot(data = zrval3, aes(y=Model, x=Season, fill=Corr)) +
geom_tile(color = "white") +
scale_fill_distiller(palette = "RdBu", limit = c(-0.6,0.6),
name="Pearson\nCorrelation") +
theme_minimal() + labs(x="")+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1)) +
coord_fixed() +
geom_text(aes(Season, Model, label = signif(Corr,digits = 2)), color = "black", size = 3)
zrk <- ggplot(data = zkval3, aes(y=Model, x=Season, fill=Corr)) +
geom_tile(color = "white") +
scale_fill_distiller(palette = "RdBu", limit = c(-0.55,0.55),
name="Kendall\nCorrelation") +
theme_minimal() + labs(x="")+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1)) +
coord_fixed() +
geom_text(aes(Season, Model, label = signif(Corr,digits = 2)), color = "black", size = 3)
zrs <- ggplot(data = zsval3, aes(y=Model, x=Season, fill=Corr)) +
geom_tile(color = "white") +
scale_fill_distiller(palette = "RdBu", limit = c(-0.75,0.75),
name="Spearman\nCorrelation") +
theme_minimal() + labs(x="")+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1)) +
coord_fixed() +
geom_text(aes(Season, Model, label = signif(Corr,digits = 2)), color = "black", size = 3)
zrb <- ggplot(data = zbia3, aes(y=Model, x=Season, fill=Bias)) +
geom_tile(color = "white")+
scale_fill_distiller(palette = "PRGn", name="Bias", limit = c(-0.49,0.49)) +
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1))+
coord_fixed() +
geom_text(aes(Season, Model, label = signif(Bias,digits = 2)), color = "black", size = 3)
zae <- ggplot(data = zmae3, aes(y=Model, x=Season, fill=MAE)) +
geom_tile(color = "white") +
scale_fill_distiller(palette = "YlOrBr", trans = "reverse", name="MAE",
limit = c(0.66,0.2)) +
theme_minimal() + labs(x="")+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1))+
coord_fixed() +
geom_text(aes(Season, Model, label = signif(MAE,digits = 2)), color = "black", size = 3)
### ---------------------------- Together -----------------------
library(cowplot) #plot_grid
png(paste0(figp,'Heatmaps_mae_clims_200_copepod_stromberg_log10.png'),
width = 9*300,        # 5 x 300 pixels
height = 9*300,
res = 300,            # 300 pixels per inch
pointsize = 8)
plot_grid( frk,zrk,fae,zae,frb,zrb,
nrow = 3, ncol = 2,
rel_widths = c(1,1), rel_heights = c(1,1) ,
align = 'h' , labels = "auto", label_size = 12, hjust = -4)
dev.off()
