cmin
cmax
rm(list=ls())
library(Hmisc) #rcorr
library(plyr)
library(cowplot) #plot_grid
source(file = "/Users/cpetrik/Dropbox/UCSC/CVC-LCM/CVC_data/outmigration_model/HighstatLibV6.r")
setwd("/Users/cpetrik/Dropbox/Princeton/Fish-MIP/CMIP6/driver_analysis/zmeso_matlab/")
figp <- "/Users/cpetrik/Dropbox/Princeton/Fish-MIP/CMIP6/driver_analysis/zmeso_figs/"
datap = "/Users/cpetrik/Dropbox/Princeton/Fish-MIP/CMIP6/driver_analysis/data_stats_zmeso/"
# load data
#Zm <- read.csv(paste0(datap,"skill_hist_model_obsglm100_all_clim_200.csv"),sep=",",header = T,stringsAsFactors = F)
#Chl <- read.csv(paste0(datap,"hist_chl_model_obsglm100_all_clim.csv"),sep=",",header = T,stringsAsFactors = F)
Zm <- read.csv(paste0(datap,"skill_hist_Stromberg_all_clim_200.csv"),sep=",",header = T,stringsAsFactors = F)
Chl <- read.csv(paste0(datap,"hist_chl_seawifs_all_clim.csv"),sep=",",header = T,stringsAsFactors = F)
SM <- as.data.frame(Zm)
SM[,5] <- as.data.frame(Chl[,3])
names(SM) <- c("Lat","Lon","mesoz","biome","chl")
SM <- na.omit(SM)
SM$Lzmeso <- log10(SM$mesoz+1e-16)
SM$Lchl <- log10(SM$chl+1e-16)
## Remove LC >45 lat BUT THIS MAY EXPAND OUTSIDE 45DEG UNDER SSP585!?!
uid1 <- which(SM$biome==1)
uid2 <- which(SM$Lat > 45 | SM$Lat < -45)
uid <- intersect(uid1,uid2)
SM <- SM[-uid,]
Slm0 <- lm(Lzmeso~Lchl, data=SM)
Slm1 <- lm(Lzmeso~Lchl, data=subset(SM, biome==1))
Slm2 <- lm(Lzmeso~Lchl, data=subset(SM, biome==2))
Slm3 <- lm(Lzmeso~Lchl, data=subset(SM, biome==3))
summary(Slm1)
summary(Slm2)
summary(Slm3)
Cff <- as.data.frame(t(coefficients(Slm0)))
Cff[2,] <- t(coefficients(Slm1))
Cff[3,] <- t(coefficients(Slm2))
Cff[4,] <- t(coefficients(Slm3))
names(Cff) <- c("Intercept","Lchl")
row.names(Cff) <- c("global","LC","HCSS","HCPS")
write.table(Cff,"Hist_coeffs_mod_chl_global_biomes_stromberg.csv",sep=",",row.names=T)
se <- as.data.frame(t(coefficients(Slm0)))
se[2,] <- t(coefficients(Slm1))
se[3,] <- t(coefficients(Slm2))
se[4,] <- t(coefficients(Slm3))
se[1,c(3:4)] <- as.data.frame(t(sqrt(diag(vcov(Slm0)))))
se[2,c(3:4)] <- sqrt(diag(vcov(Slm1)))
se[3,c(3:4)] <- sqrt(diag(vcov(Slm2)))
se[4,c(3:4)] <- sqrt(diag(vcov(Slm3)))
names(se) <- c("aSM","bSM","aSMse","bSMse")
row.names(se) <- c("Global","LC","HCSS","HCPS")
write.table(se,"Hist_std_err_biomes_stromberg.csv",sep=",",row.names=T)
## prediction tests
cmin <- log10(0.01)
cmax <- log10(25)
pchl <- exp(log(10)*seq(cmin,cmax,length=50))
plm0 <- predict(Slm0, newdata = data.frame(Lchl = log10(pchl)),
interval = "confidence")
plm1 <- predict(Slm1, newdata = data.frame(Lchl = log10(pchl)),
interval = "confidence")
plm2 <- predict(Slm2, newdata = data.frame(Lchl = log10(pchl)),
interval = "confidence")
plm3 <- predict(Slm3, newdata = data.frame(Lchl = log10(pchl)),
interval = "confidence")
CI0 <- as.data.frame(plm0)
CI1 <- as.data.frame(plm1)
CI2 <- as.data.frame(plm2)
CI3 <- as.data.frame(plm3)
CI0$Lchl <- log10(pchl)
CI1$Lchl <- log10(pchl)
CI2$Lchl <- log10(pchl)
CI3$Lchl <- log10(pchl)
write.table(CI0,"Hist_CIs_chl_global_stromberg.csv",sep=",",row.names=F)
write.table(CI1,"Hist_CIs_chl_biome1_LC_stromberg.csv",sep=",",row.names=F)
write.table(CI2,"Hist_CIs_chl_biome2_HCSS_stromberg.csv",sep=",",row.names=F)
write.table(CI3,"Hist_CIs_chl_biome3_HCPS_stromberg.csv",sep=",",row.names=F)
rm(list=ls())
library(Hmisc) #rcorr
library(plyr)
library(cowplot) #plot_grid
source(file = "/Users/cpetrik/Dropbox/UCSC/CVC-LCM/CVC_data/outmigration_model/HighstatLibV6.r")
setwd("/Users/cpetrik/Dropbox/Princeton/Fish-MIP/CMIP6/driver_analysis/zmeso_matlab/")
figp <- "/Users/cpetrik/Dropbox/Princeton/Fish-MIP/CMIP6/driver_analysis/zmeso_figs/"
datap = "/Users/cpetrik/Dropbox/Princeton/Fish-MIP/CMIP6/driver_analysis/data_stats_zmeso/"
# load data
Zm <- read.csv(paste0(datap,"skill_hist_model_obsglm100_all_clim_200.csv"),sep=",",header = T,stringsAsFactors = F)
Chl <- read.csv(paste0(datap,"hist_chl_model_obsglm100_all_clim.csv"),sep=",",header = T,stringsAsFactors = F)
Sst <- read.csv(paste0(datap,"hist_sst_model_obsglm100_all_clim.csv"),sep=",",header = T,stringsAsFactors = F)
SZm <- read.csv(paste0(datap,"skill_hist_Stromberg_all_clim_200.csv"),sep=",",header = T,stringsAsFactors = F)
SChl <- read.csv(paste0(datap,"hist_chl_seawifs_all_clim.csv"),sep=",",header = T,stringsAsFactors = F)
CM <- as.data.frame(Zm[,c(1:3,10)])
CM[,5] <- as.data.frame(Chl[,3])
CM[,6] <- as.data.frame(Sst[,3])
names(CM) <- c("Lat","Lon","mesoz","biome","chl","sst")
CM <- na.omit(CM)
MM <- as.data.frame(Zm[,c(1:2,4,11)])
MM[,5] <- as.data.frame(Chl[,4])
MM[,6] <- as.data.frame(Sst[,4])
names(MM) <- c("Lat","Lon","mesoz","biome","chl","sst")
MM <- na.omit(MM)
NM <- as.data.frame(Zm[,c(1:2,5,12)])
NM[,5] <- as.data.frame(Chl[,5])
NM[,6] <- as.data.frame(Sst[,5])
names(NM) <- c("Lat","Lon","mesoz","biome","chl","sst")
NM <- na.omit(NM)
GM <- as.data.frame(Zm[,c(1:2,6,13)])
GM[,5] <- as.data.frame(Chl[,6])
GM[,6] <- as.data.frame(Sst[,6])
names(GM) <- c("Lat","Lon","mesoz","biome","chl","sst")
GM <- na.omit(GM)
IM <- as.data.frame(Zm[,c(1:2,7,14)])
IM[,5] <- as.data.frame(Chl[,7])
IM[,6] <- as.data.frame(Sst[,7])
names(IM) <- c("Lat","Lon","mesoz","biome","chl","sst")
IM <- na.omit(IM)
UM <- as.data.frame(Zm[,c(1:2,8,15)])
UM[,5] <- as.data.frame(Chl[,8])
UM[,6] <- as.data.frame(Sst[,8])
names(UM) <- c("Lat","Lon","mesoz","biome","chl","sst")
UM <- na.omit(UM)
OG <- as.data.frame(Zm[,c(1:2,9,16)])
OG[,5] <- as.data.frame(Chl[,9])
OG[,6] <- as.data.frame(Sst[,9])
names(OG) <- c("Lat","Lon","mesoz","biome","chl","sst")
OG <- na.omit(OG)
SM <- as.data.frame(SZm)
SM[,5] <- as.data.frame(SChl[,3])
names(SM) <- c("Lat","Lon","mesoz","biome","chl")
SM <- na.omit(SM)
CM$Lzmeso <- log10(CM$mesoz+1e-16)
MM$Lzmeso <- log10(MM$mesoz+1e-16)
NM$Lzmeso <- log10(NM$mesoz+1e-16)
GM$Lzmeso <- log10(GM$mesoz+1e-16)
IM$Lzmeso <- log10(IM$mesoz+1e-16)
UM$Lzmeso <- log10(UM$mesoz+1e-16)
OG$Lzmeso <- log10(OG$mesoz+1e-16)
SM$Lzmeso <- log10(SM$mesoz+1e-16)
CM$Lchl <- log10(CM$chl+1e-16)
MM$Lchl <- log10(MM$chl+1e-16)
NM$Lchl <- log10(NM$chl+1e-16)
GM$Lchl <- log10(GM$chl+1e-16)
IM$Lchl <- log10(IM$chl+1e-16)
UM$Lchl <- log10(UM$chl+1e-16)
OG$Lchl <- log10(OG$chl+1e-16)
SM$Lchl <- log10(SM$chl+1e-16)
## Restrict latitudes to those observed
maxlat <- max(OG$Lat)
minlat <- min(OG$Lat)
CM <- subset(CM, Lat >= minlat & Lat <= maxlat)
MM <- subset(MM, Lat >= minlat & Lat <= maxlat)
NM <- subset(NM, Lat >= minlat & Lat <= maxlat)
GM <- subset(GM, Lat >= minlat & Lat <= maxlat)
IM <- subset(IM, Lat >= minlat & Lat <= maxlat)
UM <- subset(UM, Lat >= minlat & Lat <= maxlat)
## Remove LC >45 lat BUT THIS MAY EXPAND OUTSIDE 45DEG UNDER SSP585!?!
cid1 <- which(CM$biome==1)
cid2 <- which(CM$Lat > 45 | CM$Lat < -45)
cid <- intersect(cid1,cid2)
CM <- CM[-cid,]
mid1 <- which(MM$biome==1)
mid2 <- which(MM$Lat > 45 | MM$Lat < -45)
mid <- intersect(mid1,mid2)
MM <- MM[-mid,]
nid1 <- which(NM$biome==1)
nid2 <- which(NM$Lat > 45 | NM$Lat < -45)
nid <- intersect(nid1,nid2)
NM <- NM[-nid,]
gid1 <- which(GM$biome==1)
gid2 <- which(GM$Lat > 45 | GM$Lat < -45)
gid <- intersect(gid1,gid2)
GM <- GM[-gid,]
iid1 <- which(IM$biome==1)
iid2 <- which(IM$Lat > 45 | IM$Lat < -45)
iid <- intersect(iid1,iid2)
IM <- IM[-iid,]
uid1 <- which(UM$biome==1)
uid2 <- which(UM$Lat > 45 | UM$Lat < -45)
uid <- intersect(uid1,uid2)
UM <- UM[-uid,]
oid1 <- which(OG$biome==1)
oid2 <- which(OG$Lat > 45 | OG$Lat < -45)
oid <- intersect(oid1,oid2)
OG <- OG[-oid,]
sid1 <- which(SM$biome==1)
sid2 <- which(SM$Lat > 45 | SM$Lat < -45)
sid <- intersect(sid1,sid2)
SM <- SM[-sid,]
### Plots -------------------------------------------------------
xlmts2 <- c( 1, 3e4 )
## Zoo & Chl biomes sep
c1 <- ggplot(subset(CM,biome==1), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("CAN mesoz") + xlab("") + ggtitle("LC") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
c2 <- ggplot(subset(CM,biome==2), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("") + ggtitle("HCSS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
c3 <- ggplot(subset(CM,biome==3), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("") + ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
c0 <- ggplot(CM, aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("") + ggtitle("Global") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
m1 <- ggplot(subset(MM,biome==1), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("CMCC mesoz") + xlab("") + ggtitle("LC") +
scale_y_log10() + scale_x_log10(limits=c(0.02,0.15)) + theme(legend.position='none')
m2 <- ggplot(subset(MM,biome==2), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("") + ggtitle("HCSS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
m3 <- ggplot(subset(MM,biome==3), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("") + ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
m0 <- ggplot(MM, aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 500) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("") + ggtitle("Global") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
n1 <- ggplot(subset(NM,biome==1), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("CNRM mesoz") + xlab("") + #ggtitle("LC") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
n2 <- ggplot(subset(NM,biome==2), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("") + #ggtitle("HCSS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
n3 <- ggplot(subset(NM,biome==3), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("") + #ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
n0 <- ggplot(NM, aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("") + #ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
g1 <- ggplot(subset(GM,biome==1), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("GFDL mesoz") + xlab("") + #ggtitle("LC") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
g2 <- ggplot(subset(GM,biome==2), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("") + #ggtitle("HCSS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
g3 <- ggplot(subset(GM,biome==3), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("") + #ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
g0 <- ggplot(GM, aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("") + #ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
i1 <- ggplot(subset(IM,biome==1), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("IPSL mesoz") + xlab("") + #ggtitle("LC") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
i2 <- ggplot(subset(IM,biome==2), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("") + #ggtitle("HCSS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
i3 <- ggplot(subset(IM,biome==3), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("") + #ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
i0 <- ggplot(IM, aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("") + #ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
u1 <- ggplot(subset(UM,biome==1), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) + #, se=FALSE, col="blue", size = 0.25) +
ylab("UK mesoz") + xlab("") + #ggtitle("LC") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
u2 <- ggplot(subset(UM,biome==2), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("") + #ggtitle("HCSS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
u3 <- ggplot(subset(UM,biome==3), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("") + #ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
u0 <- ggplot(UM, aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("") + #ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
o1 <- ggplot(subset(OG,biome==1), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("obs mesoz") + xlab("chl") + #ggtitle("LC") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
o2 <- ggplot(subset(OG,biome==2), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("chl") + #ggtitle("HCSS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
o3 <- ggplot(subset(OG,biome==3), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("chl") + #ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
o0 <- ggplot(OG, aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("chl") + #ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
s1 <- ggplot(subset(SM,biome==1), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) + #, se=FALSE, col="blue", size = 0.25) +
ylab("Stromberg mesoz") + xlab("") + #ggtitle("LC") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
s2 <- ggplot(subset(SM,biome==2), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("") + #ggtitle("HCSS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
s3 <- ggplot(subset(SM,biome==3), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("") + #ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
s0 <- ggplot(SM, aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("") + #ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
png(paste0(figp,'scatter_hist_mesoz_chl_biomes_all_log_glm100_strom_LC45.png'),
width = 5*300,        # 5 x 300 pixels
height = 9.75*300,
res = 300,            # 300 pixels per inch
pointsize = 8)
plot_grid( m1,m2,m3,
NULL,NULL,NULL,
n1,n2,n3,
NULL,NULL,NULL,
g1,g2,g3,
NULL,NULL,NULL,
i1,i2,i3,
NULL,NULL,NULL,
u1,u2,u3,
NULL,NULL,NULL,
o1,o2,o3,
NULL,NULL,NULL,
s1,s2,s3,
nrow = 13, ncol = 3,
rel_widths = c( 1, 1, 1 ),
rel_heights = c(1,-0.15,1,-0.15,1,-0.15,1,-0.15,1,-0.15,1,-0.15,1) ,
align = 'h' )
dev.off()
## With Global
png(paste0(figp,'scatter_hist_mesoz_chl_biomes_global_all_log_glm100_strom_LC45.png'),
width = 8*300,        # 5 x 300 pixels
height = 10*300,
res = 300,            # 300 pixels per inch
pointsize = 8)
plot_grid( m1,m2,m3,m0,
NULL,NULL,NULL,NULL,
n1,n2,n3,n0,
NULL,NULL,NULL,NULL,
g1,g2,g3,g0,
NULL,NULL,NULL,NULL,
i1,i2,i3,i0,
NULL,NULL,NULL,NULL,
u1,u2,u3,u0,
NULL,NULL,NULL,NULL,
o1,o2,o3,o0,
NULL,NULL,NULL,NULL,
s1,s2,s3,s0,
nrow = 13, ncol = 4,
rel_widths = c( 1, 1, 1, 1 ),
rel_heights = c(1,-0.15,1,-0.15,1,-0.15,1,-0.15,1,-0.15,1,-0.15,1) ,
align = 'h' )
dev.off()
png(paste0(figp,'scatter_hist_mesoz_chl_biomes_global_all_log_glm100_strom_LC45.png'),
width = 8*300,        # 5 x 300 pixels
height = 11*300,
res = 300,            # 300 pixels per inch
pointsize = 8)
plot_grid( m1,m2,m3,m0,
NULL,NULL,NULL,NULL,
n1,n2,n3,n0,
NULL,NULL,NULL,NULL,
g1,g2,g3,g0,
NULL,NULL,NULL,NULL,
i1,i2,i3,i0,
NULL,NULL,NULL,NULL,
u1,u2,u3,u0,
NULL,NULL,NULL,NULL,
o1,o2,o3,o0,
NULL,NULL,NULL,NULL,
s1,s2,s3,s0,
nrow = 13, ncol = 4,
rel_widths = c( 1, 1, 1, 1 ),
rel_heights = c(1,-0.15,1,-0.15,1,-0.15,1,-0.15,1,-0.15,1,-0.15,1) ,
align = 'h' )
dev.off()
rm(list=ls())
library(Hmisc) #rcorr
library(plyr)
library(cowplot) #plot_grid
source(file = "/Users/cpetrik/Dropbox/UCSC/CVC-LCM/CVC_data/outmigration_model/HighstatLibV6.r")
setwd("/Users/cpetrik/Dropbox/Princeton/Fish-MIP/CMIP6/driver_analysis/zmeso_matlab/")
figp <- "/Users/cpetrik/Dropbox/Princeton/Fish-MIP/CMIP6/driver_analysis/zmeso_figs/"
datap = "/Users/cpetrik/Dropbox/Princeton/Fish-MIP/CMIP6/driver_analysis/data_stats_zmeso/"
# load data
#Zm <- read.csv(paste0(datap,"skill_hist_model_obsglm100_all_clim_200.csv"),sep=",",header = T,stringsAsFactors = F)
#Chl <- read.csv(paste0(datap,"hist_chl_model_obsglm100_all_clim.csv"),sep=",",header = T,stringsAsFactors = F)
Zm <- read.csv(paste0(datap,"skill_hist_COPEPOD_all_clim_200_chls.csv"),sep=",",header = T,stringsAsFactors = F)
# load data
#Zm <- read.csv(paste0(datap,"skill_hist_model_obsglm100_all_clim_200.csv"),sep=",",header = T,stringsAsFactors = F)
#Chl <- read.csv(paste0(datap,"hist_chl_model_obsglm100_all_clim.csv"),sep=",",header = T,stringsAsFactors = F)
Zm <- read.csv(paste0(datap,"skill_hist_COPEPOD_all_clim_200_chls.csv"),sep=",",header = T,stringsAsFactors = F)
# load data
#Zm <- read.csv(paste0(datap,"skill_hist_model_obsglm100_all_clim_200.csv"),sep=",",header = T,stringsAsFactors = F)
#Chl <- read.csv(paste0(datap,"hist_chl_model_obsglm100_all_clim.csv"),sep=",",header = T,stringsAsFactors = F)
Zm <- read.csv(paste0(datap,"skill_hist_COPEPOD_all_clim_200_chls.csv"),sep=",",header = T,stringsAsFactors = F)
View(Zm)
names(Zm)
SM <- as.data.frame(Zm[,c("Lat","Lon","zmeso200","SEAWIFSchl","SEAWIFSbiomes")])
SM <- na.omit(SM)
MM <- as.data.frame(Zm[,c("Lat","Lon","zmeso200","MODISchl","MODISbiomes")])
MM <- na.omit(MM)
View(SM)
SM$Lzmeso <- log10(SM$zmeso200+1e-16)
MM$Lzmeso <- log10(MM$zmeso200+1e-16)
SM$Lchl <- log10(SM$SEAWIFSchl+1e-16)
MM$Lchl <- log10(MM$MODISchl+1e-16)
View(MM)
rm(list=ls())
source(file = "/Users/cpetrik/Dropbox/UCSC/CVC-LCM/CVC_data/outmigration_model/HighstatLibV6.r")
setwd("/Users/cpetrik/Dropbox/Princeton/Fish-MIP/CMIP6/driver_analysis/zmeso_matlab/")
figp <- "/Users/cpetrik/Dropbox/Princeton/Fish-MIP/CMIP6/driver_analysis/zmeso_figs/"
datap = "/Users/cpetrik/Dropbox/Princeton/Fish-MIP/CMIP6/driver_analysis/data_stats_zmeso/"
# load data
#Zm <- read.csv(paste0(datap,"skill_hist_model_obsglm100_all_clim_200.csv"),sep=",",header = T,stringsAsFactors = F)
#Chl <- read.csv(paste0(datap,"hist_chl_model_obsglm100_all_clim.csv"),sep=",",header = T,stringsAsFactors = F)
Zm <- read.csv(paste0(datap,"skill_hist_COPEPOD_all_clim_200_chls.csv"),sep=",",header = T,stringsAsFactors = F)
SM <- as.data.frame(Zm[,c("Lat","Lon","zmeso200","SEAWIFSchl","SEAWIFSbiomes")])
SM <- na.omit(SM)
names(SM) <- c("Lat","Lon","zmeso200","chl","biome")
MM <- as.data.frame(Zm[,c("Lat","Lon","zmeso200","MODISchl","MODISbiomes")])
MM <- na.omit(MM)
names(MM) <- c("Lat","Lon","zmeso200","chl","biome")
View(MM)
View(SM)
SM$Lzmeso <- log10(SM$zmeso200+1e-16)
MM$Lzmeso <- log10(MM$zmeso200+1e-16)
SM$Lchl <- log10(SM$chl+1e-16)
MM$Lchl <- log10(MM$chl+1e-16)
## Remove LC >45 lat BUT THIS MAY EXPAND OUTSIDE 45DEG UNDER SSP585!?!
sid1 <- which(SM$biome==1)
sid2 <- which(SM$Lat > 45 | SM$Lat < -45)
sid <- intersect(sid1,sid2)
SM <- SM[-sid,]
mid1 <- which(MM$biome==1)
mid2 <- which(MM$Lat > 45 | SM$Lat < -45)
mid <- intersect(mid1,mid2)
MM <- MM[-mid,]
#Stromberg
Slm0 <- lm(Lzmeso~Lchl, data=SM)
Slm1 <- lm(Lzmeso~Lchl, data=subset(SM, biome==1))
Slm2 <- lm(Lzmeso~Lchl, data=subset(SM, biome==2))
Slm3 <- lm(Lzmeso~Lchl, data=subset(SM, biome==3))
#Obs
Mlm0 <- lm(Lzmeso~Lchl, data=MM)
Mlm1 <- lm(Lzmeso~Lchl, data=subset(MM, biome==1))
Mlm2 <- lm(Lzmeso~Lchl, data=subset(MM, biome==2))
Mlm3 <- lm(Lzmeso~Lchl, data=subset(MM, biome==3))
summary(Slm1)
summary(Mlm1)
summary(Slm2)
summary(Mlm2)
summary(Slm3)
summary(Mlm3)
Cff <- as.data.frame(t(coefficients(Slm1)))
Cff[2,] <- t(coefficients(Slm2))
View(Cff)
Cff[3,] <- t(coefficients(Slm3))
Cff[4,] <- t(coefficients(Slm0))
Cff[1,3:4] <- t(coefficients(Mlm1))
Cff[2,3:4] <- t(coefficients(Mlm2))
Cff[3,3:4] <- t(coefficients(Mlm3))
Cff[4,3:4] <- t(coefficients(Mlm0))
View(Cff)
names(Cff) <- c("SchlInt","SchlSlope","MchlInt","MchlSslope")
row.names(Cff) <- c("LC","HCSS","HCPS","global")
View(Cff)
write.table(Cff,"Hist_coeffs_chl_global_biomes_copepod.csv",sep=",",row.names=T)
write.table(Cff,paste0(datap,"Hist_coeffs_chl_global_biomes_copepod.csv"),sep=",",row.names=T)
