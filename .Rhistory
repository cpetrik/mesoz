# COPEPOD OBS
Zm <- read.csv(paste0(datap,"skill_hist_COPEPOD_all_clim_200_chls.csv"),sep=",",header = T,stringsAsFactors = F)
CSM <- as.data.frame(Zm[,c("Lat","Lon","zmeso200","SEAWIFSchl","SEAWIFSbiomes")])
CSM <- na.omit(CSM)
names(CSM) <- c("Lat","Lon","zmeso200","chl","biome")
CMM <- as.data.frame(Zm[,c("Lat","Lon","zmeso200","MODISchl","MODISbiomes")])
CMM <- na.omit(CMM)
names(CMM) <- c("Lat","Lon","zmeso200","chl","biome")
# from mgC to gC
CSM$zmeso200 <- CSM$zmeso200*1e-3
CMM$zmeso200 <- CMM$zmeso200*1e-3
CSM$Lzmeso <- log10(CSM$zmeso200+1e-16)
CMM$Lzmeso <- log10(CMM$zmeso200+1e-16)
CSM$Lchl <- log10(CSM$chl+1e-16)
CMM$Lchl <- log10(CMM$chl+1e-16)
# Remove LC >45 lat BUT THIS MAY EXPAND OUTSIDE 45DEG UNDER SSP585!?!
sid1 <- which(CSM$biome==1)
sid2 <- which(CSM$Lat > 45 | CSM$Lat < -45)
sid <- intersect(sid1,sid2)
CSM <- CSM[-sid,]
mid1 <- which(CMM$biome==1)
mid2 <- which(CMM$Lat > 45 | CMM$Lat < -45)
mid <- intersect(mid1,mid2)
CMM <- CMM[-mid,]
cm1 <- ggplot(subset(CMM,biome==1), aes(y=zmeso200, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("COPEPOD") + xlab("Mchl") + ggtitle("LC") +
scale_y_log10() + scale_x_log10(limits=c(0.02,0.15)) + theme(legend.position='none')
cm2 <- ggplot(subset(CMM,biome==2), aes(y=zmeso200, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Mchl") + ggtitle("HCSS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
cm3 <- ggplot(subset(CMM,biome==3), aes(y=zmeso200, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Mchl") + ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
cm0 <- ggplot(CMM, aes(y=zmeso200, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Mchl") + ggtitle("Global") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
cs1 <- ggplot(subset(CSM,biome==1), aes(y=zmeso200, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) + #, se=FALSE, col="blue", size = 0.25) +
ylab("COPEPOD") + xlab("Schl") + #ggtitle("LC") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
cs2 <- ggplot(subset(CSM,biome==2), aes(y=zmeso200, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Schl") + #ggtitle("HCSS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
cs3 <- ggplot(subset(CSM,biome==3), aes(y=zmeso200, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Schl") + #ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
cs0 <- ggplot(CSM, aes(y=zmeso200, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Schl") + #ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
png(paste0(figp,'scatter_hist_mesoz_chl_biomes_global_all_log_LC45.png'),
width = 8*300,        # 5 x 300 pixels
height = 9*300,
res = 300,            # 300 pixels per inch
pointsize = 8)
plot_grid( m1,m2,m3,m0,
NULL,NULL,NULL,NULL,
n1,n2,n3,n0,
NULL,NULL,NULL,NULL,
g1,g2,g3,g0,
NULL,NULL,NULL,NULL,
i1,i2,i3,i0,
NULL,NULL,NULL,NULL,
u1,u2,u3,u0,
nrow = 9, ncol = 4,
rel_widths = c( 1, 1, 1, 1 ),
rel_heights = c(1,-0.15,1,-0.15,1,-0.15,1,-0.15,1) ,
align = 'h' )
dev.off()
## Zoo & Chl biomes sep
c1 <- ggplot(subset(CM,biome==1), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("CAN zmeso") + xlab("") + ggtitle("LC") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
m1 <- ggplot(subset(MM,biome==1), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("CMCC zmeso") + xlab("") + ggtitle("LC") +
scale_y_log10() + scale_x_log10(limits=c(0.02,0.15)) + theme(legend.position='none')
n1 <- ggplot(subset(NM,biome==1), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("CNRM zmeso") + xlab("") + #ggtitle("LC") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
g1 <- ggplot(subset(GM,biome==1), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("GFDL zmeso") + xlab("") + #ggtitle("LC") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
i1 <- ggplot(subset(IM,biome==1), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("IPSL zmeso") + xlab("") + #ggtitle("LC") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
u1 <- ggplot(subset(UM,biome==1), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) + #, se=FALSE, col="blue", size = 0.25) +
ylab("UK zmeso") + xlab("chl") + #ggtitle("LC") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
png(paste0(figp,'scatter_hist_mesoz_chl_biomes_global_all_log_LC45.png'),
width = 8*300,        # 5 x 300 pixels
height = 9*300,
res = 300,            # 300 pixels per inch
pointsize = 8)
plot_grid( m1,m2,m3,m0,
NULL,NULL,NULL,NULL,
n1,n2,n3,n0,
NULL,NULL,NULL,NULL,
g1,g2,g3,g0,
NULL,NULL,NULL,NULL,
i1,i2,i3,i0,
NULL,NULL,NULL,NULL,
u1,u2,u3,u0,
nrow = 9, ncol = 4,
rel_widths = c( 1, 1, 1, 1 ),
rel_heights = c(1,-0.15,1,-0.15,1,-0.15,1,-0.15,1) ,
align = 'h' )
dev.off()
png(paste0(figp,'scatter_mesoz_chl_biomes_global_all_log_glm100_strom_copepod_LC45.png'),
width = 8*300,        # 5 x 300 pixels
height = 8*300,
res = 300,            # 300 pixels per inch
pointsize = 8)
plot_grid( o1,o2,o3,o0,
s1,s2,s3,s0,
cm1,cm2,cm3,cm0,
cs1,cs2,cs3,cs0,
nrow = 4, ncol = 4,
rel_widths = c( 1, 1, 1, 1 ),
rel_heights = c(1,1,1,1) ,
align = 'h' )
dev.off()
o1 <- ggplot(subset(OG,biome==1), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("obsGLMM") + xlab("Mchl") + ggtitle("LC") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
o2 <- ggplot(subset(OG,biome==2), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Mchl") + ggtitle("HCSS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
o3 <- ggplot(subset(OG,biome==3), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Mchl") + ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
o0 <- ggplot(OG, aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Mchl") + ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
cm1 <- ggplot(subset(CMM,biome==1), aes(y=zmeso200, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("COPEPOD") + xlab("Mchl") + #ggtitle("LC") +
scale_y_log10() + scale_x_log10(limits=c(0.02,0.15)) + theme(legend.position='none')
cm2 <- ggplot(subset(CMM,biome==2), aes(y=zmeso200, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Mchl") + #ggtitle("HCSS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
cm3 <- ggplot(subset(CMM,biome==3), aes(y=zmeso200, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Mchl") + #ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
cm0 <- ggplot(CMM, aes(y=zmeso200, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Mchl") + #ggtitle("Global") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
png(paste0(figp,'scatter_mesoz_chl_biomes_global_all_log_glm100_strom_copepod_LC45.png'),
width = 8*300,        # 5 x 300 pixels
height = 8*300,
res = 300,            # 300 pixels per inch
pointsize = 8)
plot_grid( o1,o2,o3,o0,
NULL,NULL,NULL,NULL,
s1,s2,s3,s0,
NULL,NULL,NULL,NULL,
cm1,cm2,cm3,cm0,
NULL,NULL,NULL,NULL,
cs1,cs2,cs3,cs0,
nrow = 7, ncol = 4,
rel_widths = c( 1, 1, 1, 1 ),
rel_heights = c(1,-0.15,1,-0.15,1,-0.15,1) ,
align = 'h' )
dev.off()
png(paste0(figp,'scatter_mesoz_chl_biomes_global_all_log_glm100_strom_copepod_LC45.png'),
width = 8*300,        # 5 x 300 pixels
height = 7*300,
res = 300,            # 300 pixels per inch
pointsize = 8)
plot_grid( o1,o2,o3,o0,
NULL,NULL,NULL,NULL,
s1,s2,s3,s0,
NULL,NULL,NULL,NULL,
cm1,cm2,cm3,cm0,
NULL,NULL,NULL,NULL,
cs1,cs2,cs3,cs0,
nrow = 7, ncol = 4,
rel_widths = c( 1, 1, 1, 1 ),
rel_heights = c(1,-0.15,1,-0.15,1,-0.15,1) ,
align = 'h' )
dev.off()
o1 <- ggplot(subset(OG,biome==1), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("obsGLMM") + xlab("Mchl") + ggtitle("LC") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
o2 <- ggplot(subset(OG,biome==2), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Mchl") + ggtitle("HCSS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
o3 <- ggplot(subset(OG,biome==3), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Mchl") + ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
o0 <- ggplot(OG, aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Mchl") + ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
s1 <- ggplot(subset(SM,biome==1), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) + #, se=FALSE, col="blue", size = 0.25) +
ylab("obsSM") + xlab("Schl") + #ggtitle("LC") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
s2 <- ggplot(subset(SM,biome==2), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Schl") + #ggtitle("HCSS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
s3 <- ggplot(subset(SM,biome==3), aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Schl") + #ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
s0 <- ggplot(SM, aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Schl") + #ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
cm1 <- ggplot(subset(CMM,biome==1), aes(y=zmeso200, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("COPEPOD") + xlab("Mchl") + #ggtitle("LC") +
scale_y_log10() + scale_x_log10(limits=c(0.02,0.15)) + theme(legend.position='none')
cm2 <- ggplot(subset(CMM,biome==2), aes(y=zmeso200, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Mchl") + #ggtitle("HCSS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
cm3 <- ggplot(subset(CMM,biome==3), aes(y=zmeso200, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Mchl") + #ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
cm0 <- ggplot(CMM, aes(y=zmeso200, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Mchl") + #ggtitle("Global") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
cs1 <- ggplot(subset(CSM,biome==1), aes(y=zmeso200, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) + #, se=FALSE, col="blue", size = 0.25) +
ylab("COPEPOD") + xlab("Schl") + #ggtitle("LC") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
cs2 <- ggplot(subset(CSM,biome==2), aes(y=zmeso200, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Schl") + #ggtitle("HCSS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
cs3 <- ggplot(subset(CSM,biome==3), aes(y=zmeso200, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Schl") + #ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
cs0 <- ggplot(CSM, aes(y=zmeso200, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Schl") + #ggtitle("HCPS") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
png(paste0(figp,'scatter_mesoz_chl_biomes_global_all_log_glm100_strom_copepod_LC45.png'),
width = 8*300,        # 5 x 300 pixels
height = 7*300,
res = 300,            # 300 pixels per inch
pointsize = 8)
plot_grid( o1,o2,o3,o0,
NULL,NULL,NULL,NULL,
s1,s2,s3,s0,
NULL,NULL,NULL,NULL,
cm1,cm2,cm3,cm0,
NULL,NULL,NULL,NULL,
cs1,cs2,cs3,cs0,
nrow = 7, ncol = 4,
rel_widths = c( 1, 1, 1, 1 ),
rel_heights = c(1,-0.15,1,-0.15,1,-0.15,1) ,
align = 'h' )
dev.off()
png(paste0(figp,'scatter_mesoz_chl_biomes_global_all_log_glm100_strom_copepod_LC45.png'),
width = 8*300,        # 5 x 300 pixels
height = 7*300,
res = 300,            # 300 pixels per inch
pointsize = 8)
plot_grid( o1,o2,o3,o0,
NULL,NULL,NULL,NULL,
s1,s2,s3,s0,
NULL,NULL,NULL,NULL,
cm1,cm2,cm3,cm0,
NULL,NULL,NULL,NULL,
cs1,cs2,cs3,cs0,
nrow = 7, ncol = 4,
rel_widths = c( 1, 1, 1, 1 ),
rel_heights = c(1,-0.1,1,-0.1,1,-0.1,1) ,
align = 'h' )
dev.off()
png(paste0(figp,'scatter_mesoz_chl_biomes_global_all_log_glm100_strom_copepod_LC45.png'),
width = 8*300,        # 5 x 300 pixels
height = 7*300,
res = 300,            # 300 pixels per inch
pointsize = 8)
plot_grid( o1,o2,o3,o0,
NULL,NULL,NULL,NULL,
s1,s2,s3,s0,
NULL,NULL,NULL,NULL,
cm1,cm2,cm3,cm0,
NULL,NULL,NULL,NULL,
cs1,cs2,cs3,cs0,
nrow = 7, ncol = 4,
rel_widths = c( 1, 1, 1, 1 ),
rel_heights = c(1,-0.05,1,-0.05,1,-0.05,1) ,
align = 'h' )
dev.off()
png(paste0(figp,'scatter_mesoz_chl_biomes_global_all_log_glm100_strom_copepod_LC45.png'),
width = 8*300,        # 5 x 300 pixels
height = 8*300,
res = 300,            # 300 pixels per inch
pointsize = 8)
plot_grid( o1,o2,o3,o0,
NULL,NULL,NULL,NULL,
s1,s2,s3,s0,
NULL,NULL,NULL,NULL,
cm1,cm2,cm3,cm0,
NULL,NULL,NULL,NULL,
cs1,cs2,cs3,cs0,
nrow = 7, ncol = 4,
rel_widths = c( 1, 1, 1, 1 ),
rel_heights = c(1,-0.05,1,-0.05,1,-0.05,1) ,
align = 'h' )
dev.off()
o0 <- ggplot(OG, aes(y=mesoz, x=chl)) + theme_bw(base_size=12) +
geom_bin2d(bins = 100) + scale_fill_continuous(type = "viridis") +
geom_smooth(method="lm", se=FALSE, col="red", size = 0.25) +
ylab("") + xlab("Mchl") + ggtitle("Global") +
scale_y_log10() + scale_x_log10() + theme(legend.position='none')
png(paste0(figp,'scatter_mesoz_chl_biomes_global_all_log_glm100_strom_copepod_LC45.png'),
width = 8*300,        # 5 x 300 pixels
height = 8*300,
res = 300,            # 300 pixels per inch
pointsize = 8)
plot_grid( o1,o2,o3,o0,
NULL,NULL,NULL,NULL,
s1,s2,s3,s0,
NULL,NULL,NULL,NULL,
cm1,cm2,cm3,cm0,
NULL,NULL,NULL,NULL,
cs1,cs2,cs3,cs0,
nrow = 7, ncol = 4,
rel_widths = c( 1, 1, 1, 1 ),
rel_heights = c(1,-0.05,1,-0.05,1,-0.05,1) ,
align = 'h' )
dev.off()
rm(list=ls())
source(file = "/Users/cpetrik/Dropbox/UCSC/CVC-LCM/CVC_data/outmigration_model/HighstatLibV6.r")
setwd("/Users/cpetrik/Dropbox/Princeton/Fish-MIP/CMIP6/driver_analysis/zmeso_matlab/")
figp <- "/Users/cpetrik/Dropbox/Princeton/Fish-MIP/CMIP6/driver_analysis/zmeso_figs/"
library(Hmisc)
library(ggplot2)
library(gridExtra)
library(corrgram)
library(scatterplot3d)
library(rpart)
library(tree)
library(pvclust)
library(mclust)
library(dendextend)
library(gplots)
library("corrplot")
library(scico)
library(reshape2)
### -------------------------------- Raw 4rt -------------------------------
# load data
ddir <- "/Users/cpetrik/Dropbox/Princeton/Fish-MIP/CMIP6/driver_analysis/data_stats_zmeso/"
frval <- read.csv(paste0(ddir,"corr_hist_clims_200_obsglm100_raw_4rt.csv"),sep=",",header = T,stringsAsFactors = F)
frms <- read.csv(paste0(ddir,"urmse_hist_clims_200_obsglm100_raw_4rt.csv"),sep=",",header = T,stringsAsFactors = F)
fbia <- read.csv(paste0(ddir,"bias_hist_clims_200_obsglm100_raw_4rt.csv"),sep=",",header = T,stringsAsFactors = F)
names(frval)[1] <- "Model"
names(frms)[1] <- "Model"
names(fbia)[1] <- "Model"
frval3 <- melt(frval)
names(frval3) <- c("Model","Season","Corr")
frms3 <- melt(frms)
names(frms3) <- c("Model","Season","RMSE")
fbia3 <- melt(fbia)
names(fbia3) <- c("Model","Season","Bias")
frval3$Model <- factor(frval3$Model,levels = c("UK","IPSL","GFDL","CNRM","CMCC","CAN"))
frms3$Model <- factor(frms3$Model,levels = c("UK","IPSL","GFDL","CNRM","CMCC","CAN"))
fbia3$Model <- factor(fbia3$Model,levels = c("UK","IPSL","GFDL","CNRM","CMCC","CAN"))
frms3$RMSE <- abs(frms3$RMSE)
### Heatmaps
fr <- ggplot(data = frval3, aes(y=Model, x=Season, fill=Corr)) +
geom_tile(color = "white") +
scale_fill_distiller(palette = "RdBu", limit = c(-0.77,0.77),
name="Pearson\nCorrelation") +
theme_minimal() + labs(x="")+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1)) +
coord_fixed() +
geom_text(aes(Season, Model, label = signif(Corr,digits = 2)), color = "black", size = 3)
frm <- ggplot(data = frms3, aes(y=Model, x=Season, fill=RMSE)) +
geom_tile(color = "white") +
scale_fill_distiller(palette = "YlOrBr", trans = "reverse", name="RMSE",
limit = c(0.37,0.11)) +
theme_minimal() + labs(x="")+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1))+
coord_fixed() +
geom_text(aes(Season, Model, label = signif(RMSE,digits = 2)), color = "black", size = 3)
frb <- ggplot(data = fbia3, aes(y=Model, x=Season, fill=Bias)) +
geom_tile(color = "white")+
scale_fill_distiller(palette = "PRGn", name="Bias", limit = c(-0.25,0.25)) +
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1))+
coord_fixed() +
geom_text(aes(Season, Model, label = signif(Bias,digits = 2)), color = "black", size = 3)
### -------------------------------- -1 to 1 using 4th rt -------------------------------
# load data
zrval <- read.csv(paste0(ddir,"corr_hist_clims_200_obsglm100_neg11_4rt.csv"),sep=",",header = T,stringsAsFactors = F)
zrms <- read.csv(paste0(ddir,"urmse_hist_clims_200_obsglm100_neg11_4rt.csv"),sep=",",header = T,stringsAsFactors = F)
zbia <- read.csv(paste0(ddir,"bias_hist_clims_200_obsglm100_neg11_4rt.csv"),sep=",",header = T,stringsAsFactors = F)
names(zrval)[1] <- "Model"
names(zrms)[1] <- "Model"
names(zbia)[1] <- "Model"
zrval3 <- melt(zrval)
names(zrval3) <- c("Model","Season","Corr")
zrms3 <- melt(zrms)
names(zrms3) <- c("Model","Season","RMSE")
zbia3 <- melt(zbia)
names(zbia3) <- c("Model","Season","Bias")
zrval3$Model <- factor(zrval3$Model,levels = c("UK","IPSL","GFDL","CNRM","CMCC","CAN"))
zrms3$Model <- factor(zrms3$Model,levels = c("UK","IPSL","GFDL","CNRM","CMCC","CAN"))
zbia3$Model <- factor(zbia3$Model,levels = c("UK","IPSL","GFDL","CNRM","CMCC","CAN"))
zrms3$RMSE <- abs(zrms3$RMSE)
### Heatmaps
zr <- ggplot(data = zrval3, aes(y=Model, x=Season, fill=Corr)) +
geom_tile(color = "white")+
scale_fill_distiller(palette = "RdBu", limit = c(-0.77,0.77),
name="Pearson\nCorrelation") +
theme_minimal()+ labs(x="",y="")+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1))+
coord_fixed() +
geom_text(aes(Season, Model, label = signif(Corr,digits = 2)), color = "black", size = 3)
zrm <- ggplot(data = zrms3, aes(y=Model, x=Season, fill=RMSE)) +
geom_tile(color = "white") +
scale_fill_distiller(palette = "YlOrBr", trans = "reverse", name="RMSE",
limit = c(1.7,0.6)) +
theme_minimal() + labs(x="",y="")+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1))+
coord_fixed() +
geom_text(aes(Season, Model, label = signif(RMSE,digits = 2)), color = "black", size = 3)
zrb <- ggplot(data = zbia3, aes(y=Model, x=Season, fill=Bias)) +
geom_tile(color = "white")+
scale_fill_distiller(palette = "PRGn", name="Bias", limit = c(-0.35,0.35)) +
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 8, hjust = 1))+
coord_fixed() + labs(y="")+
geom_text(aes(Season, Model, label = signif(Bias,digits = 2)), color = "black", size = 3)
### ---------------------------- Together -----------------------
library(cowplot) #plot_grid
png(paste0(figp,'Heatmaps_urmse_clims_200_obsglm100_raw_neg11_4rt.png'),
width = 9*300,        # 5 x 300 pixels
height = 9*300,
res = 300,            # 300 pixels per inch
pointsize = 8)
plot_grid( fr,zr,frm,zrm,frb,zrb,
nrow = 3, ncol = 2,
rel_widths = c(1,1), rel_heights = c(1,1) ,
align = 'h' , labels = "auto", label_size = 12, hjust = -4)
dev.off()
